webpackJsonp([1],{"+BTi":function(e,t){},"+Rdb":function(e,t){},"/bpg":function(e,t){},"00NJ":function(e,t){},"2rGO":function(e,t){},"8z31":function(e,t){},Dte2:function(e,t){},EYpU:function(e,t){},GXEp:function(e,t){},H3rH:function(e,t){},I4nB:function(e,t){},"IUI+":function(e,t){},J373:function(e,t){},J7ij:function(e,t){},KJFM:function(e,t){},L1Xy:function(e,t){},NHnr:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r("oq7i"),r("+BTi");var a=r("+TD8"),o=r.n(a),n=(r("cwe7"),r("2X9z")),s=r.n(n),i=(r("IUI+"),r("h2ff")),l=r.n(i),c=(r("xBlb"),r("dVA0")),u=r.n(c),d=(r("ylrw"),r("6oiW")),m=r.n(d),p=(r("00NJ"),r("VosF")),v=r.n(p),f=(r("uKbn"),r("GegP")),h=r.n(f),_=(r("hXTu"),r("y7os")),b=r.n(_),g=(r("vBcO"),r("ARSI")),k=r.n(g),F=(r("2rGO"),r("nu7/")),y=r.n(F),w=(r("wJKS"),r("orbS")),x=r.n(w),C=(r("8z31"),r("SXzR")),S=r.n(C),D=(r("Dte2"),r("q4le")),E=r.n(D),$=(r("isE6"),r("LR6y")),I=r.n($),L=(r("Q6SQ"),r("LQMI")),N=r.n(L),R=(r("Yq4J"),r("qubY")),V=r.n(R),z=(r("I4nB"),r("STLj")),W=r.n(z),U=(r("cDSy"),r("e0Bm")),j=r.n(U),B=(r("jZDA"),r("91Nw")),T=r.n(B),A=(r("d7TW"),r("ajQY")),H=r.n(A),O=(r("X+ky"),r("HJMx")),q=r.n(O),P=(r("qunJ"),r("vqwl")),G=r.n(P),M=(r("+Rdb"),r("Mezo")),J=r.n(M),X=(r("jAzQ"),r("wOhx")),K=r.n(X),Q=(r("Z1wW"),r("raHz")),Y=r.n(Q),Z=(r("EYpU"),r("9Y4M")),ee=r.n(Z),te=(r("dmRH"),r("EKTV")),re=r.n(te),ae=(r("TFIm"),r("s3ue")),oe=r.n(ae),ne=(r("bwiK"),r("SExR")),se=r.n(ne),ie=(r("/bpg"),r("ACGT")),le=r.n(ie),ce=(r("NOFV"),r("mWcH")),ue=r.n(ce),de=(r("w2s5"),r("oTyR")),me=r.n(de),pe=(r("ZzA9"),r("cgIP")),ve=r.n(pe),fe=(r("H3rH"),r("6mNG")),he=r.n(fe),_e=(r("GXEp"),r("mtrD")),be=r.n(_e),ge=r("7+uW"),ke=(r("J373"),{render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]});var Fe=r("VU/8")({name:"App"},ke,!1,function(e){r("KJFM")},null,null).exports,ye=r("/ocq"),we={data:function(){return{defaultUrl:""}},watch:{$route:"getPath"},mounted:function(){this.defaultUrl=window.location.href.split("/#")[1]},methods:{getPath:function(){this.defaultUrl=this.$route.path},imageToHome:function(){this.$router.replace("/home")},logOut:function(){window.sessionStorage.removeItem("userId"),this.$router.push("/login")}}},xe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",[a("div",{staticClass:"home-header"},[a("img",{attrs:{src:r("voD/"),alt:""},on:{click:e.imageToHome}}),e._v("\n      企业风险点位评估系统\n    ")]),e._v(" "),a("div",[a("el-button",{attrs:{type:"info"},on:{click:e.logOut}},[e._v("退出")])],1)]),e._v(" "),a("el-container",[a("el-aside",{attrs:{width:"200px"}},[a("el-menu",{attrs:{router:"","default-active":e.defaultUrl}},[a("el-menu-item",{attrs:{index:"/enterpriseInformation"}},[a("i",{staticClass:"el-icon-s-data"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("企业信息分析")])]),e._v(" "),a("el-menu-item",{attrs:{index:"/enterpriseDistributionMap"}},[a("i",{staticClass:"el-icon-location"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("企业地图分布")])]),e._v(" "),a("el-menu-item",{attrs:{index:"/insertEnterpriseDetails"}},[a("i",{staticClass:"el-icon-user-solid"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("企业信息录入")])])],1)],1),e._v(" "),a("el-main",[a("router-view")],1)],1)],1)},staticRenderFns:[]};var Ce=r("VU/8")(we,xe,!1,function(e){r("rRW2")},"data-v-70084f81",null).exports,Se=r("Xxa5"),De=r.n(Se),Ee=r("exGp"),$e=r.n(Ee),Ie={data:function(){return{isDisabled:!0,step:"下一步",active:0,dialogFormVisible:!0,form:{tableName:"",delivery:!1,type:[],resource:"",desc:""},formLabelWidth:"120px",ruleForm:{influenceFactor:"",isDisabled:!1},sizeForm:{tableId:"",tableName:"",categoryId:1,influenceFactor:"",determineFactor:"",score:"",photo:"",isDisabled:!0},formList:[],rules:{influenceFactor:[{required:!0,message:"请输入影响因素",trigger:"blur"}],tableName:[{required:!0,message:"请输入表名",trigger:"blur"}],determineFactor:[{required:!0,message:"请输入判定要素",trigger:"blur"}],score:[{required:!0,message:"请输入分数",trigger:"blur"},{type:"number",message:"分数必须为数字值"}]}}},methods:{submitInfluenceFactor:function(e){var t,r=this;this.$refs[e].validate((t=$e()(De.a.mark(function e(t){var a,o;return De.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=9;break}return e.next=3,r.$http.post("/insert/table/influence",{tableId:r.sizeForm.tableId,tableName:r.sizeForm.tableName,categoryId:r.sizeForm.categoryId,influenceFactor:r.ruleForm.influenceFactor});case 3:a=e.sent,o=a.data,console.log(o),"SUCCESS"===o.result&&(r.sizeForm.isDisabled=!1,r.$message.success("保存成功")),e.next=11;break;case 9:return r.$message.error("请输入影响因素在保存"),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,r)})),function(e){return t.apply(this,arguments)}))},nextStep:function(){this.formList.splice(0,this.formList.length),this.ruleForm.isDisabled=!1,this.sizeForm.isDisabled=!0,this.isDisabled=!0,3==this.sizeForm.categoryId++&&(this.isDisabled=!1,this.step="完成"),this.active++>2&&(this.$message.success("成功录入改模板信息！"),this.$router.push({path:"/tableinsert"}),location.reload())},handleClose:function(e){var t=this;this.$confirm("确认关闭？").then(function(r){e(),t.$router.push({path:"/home"})}).catch(function(e){})},downDialogFormVisible:function(){this.dialogFormVisible=!1,this.$router.push({path:"/home"})},upDialogFormVisible:function(e){var t,r=this;this.$refs[e].validate((t=$e()(De.a.mark(function e(t){var a,o;return De.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=8;break}return e.next=3,r.$http.post("/insert/table",{tableName:r.form.tableName});case 3:a=e.sent,"SUCCESS"===(o=a.data).result?(r.sizeForm.tableId=o.data.id,r.sizeForm.tableName=o.data.tableName,r.$message.success("录入成功！"),r.dialogFormVisible=!1):(r.$message.error("录入失败，请重新提交"),r.dialogFormVisible=!0),e.next=10;break;case 8:return r.$message.error("请输入模板名称在提交"),e.abrupt("return",!1);case 10:case"end":return e.stop()}},e,r)})),function(e){return t.apply(this,arguments)}))},onSubmit:function(e){var t,r=this;this.$refs[e].validate((t=$e()(De.a.mark(function e(t){var a,o;return De.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=8;break}return e.next=3,r.$http.post("/insert/table/details",{tableId:r.sizeForm.tableId,tableName:r.sizeForm.tableName,categoryId:r.sizeForm.categoryId,influenceFactor:r.ruleForm.influenceFactor,determineFactor:r.sizeForm.determineFactor,score:r.sizeForm.score,photo:r.sizeForm.determineFactor+"图片"});case 3:a=e.sent,"SUCCESS"===(o=a.data).result?(r.isDisabled=!1,r.formList.push(o.data),r.$message.success("录入成功！")):r.$message.error("录入失败，请重新提交"),e.next=10;break;case 8:return r.$message.error("请输入相关信息在提交"),e.abrupt("return",!1);case 10:case"end":return e.stop()}},e,r)})),function(e){return t.apply(this,arguments)}))}}},Le={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",[r("el-steps",{staticStyle:{"margin-top":"1px"},attrs:{active:e.active,"finish-status":"success",simple:""}},[r("el-step",{attrs:{title:"事故后果"}}),e._v(" "),r("el-step",{attrs:{title:"事故可能性"}}),e._v(" "),r("el-step",{attrs:{title:"事故/人群暴露"}})],1)],1),e._v(" "),r("div",[r("el-dialog",{attrs:{title:"录入表格模板",visible:e.dialogFormVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[r("el-form-item",{attrs:{label:"表格名称","label-width":e.formLabelWidth,prop:"tableName"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.tableName,callback:function(t){e.$set(e.form,"tableName",t)},expression:"form.tableName"}})],1),e._v(" "),r("el-form-item",[r("el-button",{on:{click:e.downDialogFormVisible}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.upDialogFormVisible("form")}}},[e._v("确 定")])],1)],1)],1)],1),e._v(" "),r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,disabled:e.ruleForm.isDisabled,"label-width":"100px"}},[r("div",{staticClass:"influenceFactor-css"},[r("el-form-item",{attrs:{label:"影响因素：",prop:"influenceFactor"}},[r("el-input",{model:{value:e.ruleForm.influenceFactor,callback:function(t){e.$set(e.ruleForm,"influenceFactor",t)},expression:"ruleForm.influenceFactor"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitInfluenceFactor("ruleForm")}}},[e._v("保存")])],1)],1)]),e._v(" "),r("el-form",{ref:"sizeForm",attrs:{model:e.sizeForm,disabled:e.sizeForm.isDisabled,"label-width":"100px",rules:e.rules}},[r("div",{staticClass:"form-css"},[r("el-form-item",{attrs:{label:"判定要素：",prop:"determineFactor"}},[r("el-input",{model:{value:e.sizeForm.determineFactor,callback:function(t){e.$set(e.sizeForm,"determineFactor",t)},expression:"sizeForm.determineFactor"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"赋分标准：",prop:"score"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.sizeForm.score,callback:function(t){e.$set(e.sizeForm,"score",e._n(t))},expression:"sizeForm.score"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary",autofocus:""},on:{click:function(t){return e.onSubmit("sizeForm")}}},[e._v("提交")])],1)],1)]),e._v(" "),r("div",[r("el-card",{staticClass:"box-card"},[r("h3",[e._v("模板名称："+e._s(e.sizeForm.tableName))]),e._v(" "),e._l(this.formList,function(t,a){return r("div",{key:a,staticClass:"text item"},[e._v("\n        影响因素："+e._s(t.influenceFactor)+"\n        判定要素："+e._s(t.determineFactor)+"\n        赋分标准："+e._s(t.score)+"\n      ")])}),e._v(" "),r("el-button",{staticClass:"button",attrs:{type:"primary",disabled:e.isDisabled},on:{click:e.nextStep}},[e._v(e._s(this.step))])],2)],1)],1)},staticRenderFns:[]};var Ne=r("VU/8")(Ie,Le,!1,function(e){r("L1Xy")},"data-v-781bd39c",null).exports,Re={data:function(){return{tableHeight:window.innerHeight-103,otherEnterpriseId:"",formShow:!0,otherDialogFormVisible:!1,otherEnterpriseForm:{otherCompanyName:"",otherPrincipal:"",otherNumber:"",otherLng:"",otherLat:""},otherFormData:{},otherForm:{valuationCategory:"",majorRiskCategory:"",L:"",E:"",C:"",R:"",riskLevel:""},otherTableData:[],wordButtonIsDisabled:!1,wordFileList:[],upGreen:[],enterpriseId:"",checkBoxData:[],influenceFactorDetails:[],fileList:[],indexNumber:"",checkBoxForm:{checkList:[],list:{},type:[]},insertInfluenceFactorDialogFormVisible:!1,formWorkForm:{region:"",isDisabled:!1},tableData:[],tableIsDistable:!1,dialogFormVisible:!1,form:{isDisabled:!0,companyName:"",principal:"",address:"",informant:"",informantNumber:"",lng:"",lat:"",totalNumber:"",riskValue:"",measure:"",majorDanger:"",majorRiskName:""},formLabelWidth:"120px",options:[],value:"",rules:{region:[{required:!0,message:"请选择相应模板",trigger:"change"}],type:[{type:"array",required:!0,message:"请至少选择一个选项",trigger:"change"}],riskValue:[{required:!0,message:"风险值不能为空"},{type:"number",message:"风险值必须为数字值"}],companyName:[{required:!0,message:"单位名称不能为空"}],valuationCategory:[{required:!0,message:"评估类别不能为空"}],majorRiskCategory:[{required:!0,message:"主要风险类别不能为空"}],L:[{required:!0,message:"L不能为空"},{type:"number",message:"L必须为数字值"}],E:[{required:!0,message:"E不能为空"},{type:"number",message:"E必须为数字值"}],C:[{required:!0,message:"C不能为空"},{type:"number",message:"C必须为数字值"}],R:[{required:!0,message:"R不能为空"},{type:"number",message:"R必须为数字值"}],riskLevel:[{required:!0,message:"请选择风险等级",trigger:"change"}],otherCompanyName:[{required:!0,message:"单位名称不能为空"}]}}},mounted:function(){this.getAllFormWork()},watch:{},methods:{upOtherDialogFormVisible:function(){this.otherDialogFormVisible=!0,this.formShow=!1,this.otherEnterpriseId="",this.otherTableData=[],this.wordFileList=[],this.otherEnterpriseForm={},this.otherForm={}},otherFormDialogFormVisible:function(e){var t,r=this;this.$refs[e].validate((t=$e()(De.a.mark(function e(t){var a,o;return De.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=8;break}return e.next=3,r.$http.post("/save/other/enterprise",{otherCompanyName:r.otherEnterpriseForm.otherCompanyName,otherPrincipal:r.otherEnterpriseForm.otherPrincipal,otherNumber:r.otherEnterpriseForm.otherNumber,otherLng:r.otherEnterpriseForm.otherLng,otherLat:r.otherEnterpriseForm.otherLat});case 3:a=e.sent,"SUCCESS"===(o=a.data).result?(r.otherEnterpriseId=o.data,r.$message.success("录入成功！"),r.otherDialogFormVisible=!1):r.$message.error("录入失败！请重新录入"),e.next=9;break;case 8:return e.abrupt("return",!1);case 9:case"end":return e.stop()}},e,r)})),function(e){return t.apply(this,arguments)}))},handleClose:function(e){""===this.enterpriseId?e():this.$message.error("窗口不能被关闭，请检查模板是否已确认")},otherSubmitForm:function(e){var t,r=this;this.$refs[e].validate((t=$e()(De.a.mark(function e(t){var a,o;return De.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=12;break}if(""===r.otherEnterpriseId){e.next=9;break}return e.next=4,r.$http.post("/save/other/influence/details",{otherEnterpriseId:r.otherEnterpriseId,valuationCategory:r.otherForm.valuationCategory,majorRiskCategory:r.otherForm.majorRiskCategory,judgeL:r.otherForm.L,judgeE:r.otherForm.E,judgeC:r.otherForm.C,judgeR:r.otherForm.R,riskLevel:r.otherForm.riskLevel});case 4:a=e.sent,"SUCCESS"===(o=a.data).result&&(r.$message.success("录入成功"),r.otherTableData.push(o.data)),e.next=10;break;case 9:r.$message.error("请录入其他企业信息再进行录入");case 10:e.next=14;break;case 12:return r.$message.warning("请输入后在点击录入"),e.abrupt("return",!1);case 14:case"end":return e.stop()}},e,r)})),function(e){return t.apply(this,arguments)}))},otherResetForm:function(e){this.$refs[e].resetFields()},wordHandleSuccess:function(e){var t=this;return $e()(De.a.mark(function r(){var a,o;return De.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if("SUCCESS"!==e.result){r.next=17;break}if(""===t.enterpriseId){r.next=9;break}return r.next=4,t.$http.post("/save/word/url",{enterpriseId:t.enterpriseId,wordUrl:e.data});case 4:a=r.sent,"SUCCESS"===a.data.result?t.$message.success("上传成功"):t.$message.error("上传失败！请重新上传"),r.next=15;break;case 9:if(""===t.otherEnterpriseId){r.next=15;break}return r.next=12,t.$http.post("/save/other/word/url",{otherEnterpriseId:t.otherEnterpriseId,otherWordUrl:e.data});case 12:o=r.sent,"SUCCESS"===o.data.result?t.$message.success("上传成功"):t.$message.error("上传失败！请重新上传");case 15:r.next=18;break;case 17:t.$message.error("上传失败！请重新上传");case 18:case"end":return r.stop()}},r,t)}))()},otherSubmitUpload:function(){this.$refs.upload.submit(),console.log(this.wordFileList),this.wordFileList.length>0&&this.$message.warning("相应文档已上传！")},submitUpload:function(){this.$refs.upload.submit(),this.wordFileList.length>0&&this.$message.warning("相应文档已上传！")},wordHandlePreview:function(e){console.log(e)},wordHandleRemove:function(e,t){console.log(e,t)},wordHandleExceed:function(e,t){this.$message.warning("每家企业只能选择 1 个文件，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},upInsertInfluenceFactorDialogFormVisible:function(){var e=this;return $e()(De.a.mark(function t(){var r;return De.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.checkBoxForm.type.length>0)){t.next=9;break}return e.checkBoxForm.type.forEach(function(t,r){var a="";e.checkBoxForm.list.tableDetailsList.forEach(function(e,r){t===e.determineFactor&&(a=e.score)});var o="";e.checkBoxData.forEach(function(e,r){t+"图片"===e.determineFactor&&(o=e.photo+","+o)}),o.length>0&&(o=o.substr(0,o.length-1)),e.influenceFactorDetails.push({enterpriseId:e.enterpriseId,categoryId:e.checkBoxForm.list.categoryId,influenceFactor:e.checkBoxForm.list.influenceFactor,determineFactor:t,score:a,photo:o})}),t.next=4,e.$http.post("/save/influence/factor/details",{influenceFactorDetailsList:e.influenceFactorDetails});case 4:r=t.sent,"SUCCESS"===r.data.result?(e.$message.success("录入成功！"),e.influenceFactorDetails=[],e.checkBoxData=[],e.fileList=[],e.checkBoxForm.type=[],e.upGreen.push(e.indexNumber),e.insertInfluenceFactorDialogFormVisible=!1):e.$message.error("录入失败！请重新录入！"),t.next=11;break;case 9:return e.$message.error("请选择后在提交！"),t.abrupt("return",!1);case 11:case"end":return t.stop()}},t,e)}))()},downInsertInfluenceFactorDialogFormVisible:function(){this.checkBoxData=[],this.fileList=[],this.checkBoxForm.type=[],this.insertInfluenceFactorDialogFormVisible=!1},enterpriseFormDialogFormVisible:function(e){var t,r=this;this.$refs[e].validate((t=$e()(De.a.mark(function e(t){var a,o;return De.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=8;break}return e.next=3,r.$http.post("/save/enterprise",{companyType:r.formWorkForm.region,companyName:r.form.companyName,principal:r.form.principal,address:r.form.address,informant:r.form.informant,informantNumber:r.form.informantNumber,lng:r.form.lng,lat:r.form.lat,totalNumber:r.form.totalNumber,riskValue:r.form.riskValue,measure:r.form.measure,majorDanger:r.form.majorDanger,majorRiskName:r.form.majorRiskName});case 3:a=e.sent,"SUCCESS"===(o=a.data).result?(r.$message.success("保存成功"),r.enterpriseId=o.data,r.tableIsDistable=!1,r.dialogFormVisible=!1,r.wordButtonIsDisabled=!1):r.$message.error("保存失败，请重试"),e.next=10;break;case 8:return r.$message.warning("请检查输入是否已输入或格式是否正确"),e.abrupt("return",!1);case 10:case"end":return e.stop()}},e,r)})),function(e){return t.apply(this,arguments)}))},handleSuccess:function(e,t,r,a){this.checkBoxData.push({determineFactor:a,photo:e.data})},handleRemove:function(e,t){var r=this;this.checkBoxData.forEach(function(t,a){e.response.data===t.photo&&r.checkBoxData.splice(a,1)})},handlePreview:function(e){console.log(e)},upDialogFormVisible:function(){this.dialogFormVisible=!0,this.form.isDisabled=!0},handleEdit:function(e,t){if(-1!==this.upGreen.indexOf(e))return this.$message.warning("选项只能入录一次！该选项已被录入！"),!1;""!==this.enterpriseId?(this.insertInfluenceFactorDialogFormVisible=!0,this.checkBoxForm.list=t,this.indexNumber=e):this.$message.error("请先录入企业信息后再进行录入")},handleDelete:function(e,t){console.log(e,t)},selectFormWork:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$message.warning("请选择相应模板"),!1;t.$confirm("请录入下面相关企业信息再进行相关详细信息录入，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then($e()(De.a.mark(function e(){var r,a;return De.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("/get/table/by/id",{params:{tableId:t.formWorkForm.region}});case 2:r=e.sent,"SUCCESS"===(a=r.data).result?(t.$message({type:"success",message:"获取成功"}),t.tableData=a.data,t.form.isDisabled=!1,t.upGreen=[],t.wordFileList=[],t.enterpriseId="",t.otherTableData=[],t.formShow=!0,t.otherEnterpriseId=""):t.$message({type:"error",message:"获取失败，请重新选择"});case 5:case"end":return e.stop()}},e,t)}))).catch(function(){t.$message({type:"info",message:"请重新选择"})})})},getAllFormWork:function(){var e=this;return $e()(De.a.mark(function t(){var r,a;return De.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/get/all/formwork");case 2:r=t.sent,"SUCCESS"===(a=r.data).result&&(e.options=a.data);case 5:case"end":return t.stop()}},t,e)}))()}}},Ve={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{"background-color":"white",height:"99.5%",margin:"1px"}},[r("div",{staticClass:"enterprise-css"},[r("div",[r("el-select",{staticStyle:{width:"350px"},attrs:{disabled:"",placeholder:"模板"},model:{value:e.formWorkForm.region,callback:function(t){e.$set(e.formWorkForm,"region",t)},expression:"formWorkForm.region"}},e._l(e.options,function(e){return r("el-option",{key:e.id,attrs:{label:e.tableName,value:e.id}})}),1),e._v(" "),r("el-button",{attrs:{type:"success"},on:{click:e.upDialogFormVisible}},[e._v("企业信息录入")]),e._v(" "),r("el-button",{attrs:{type:"info"},on:{click:e.upOtherDialogFormVisible}},[e._v("其他企业录入")])],1),e._v(" "),r("div",{staticClass:"upload-button"},[r("el-upload",{ref:"upload",staticClass:"my-upload-demo",attrs:{action:"http://localhost:7000/save/photo","on-preview":e.wordHandlePreview,"on-remove":e.wordHandleRemove,"on-success":e.wordHandleSuccess,limit:1,"on-exceed":e.wordHandleExceed,"auto-upload":!1,"file-list":e.wordFileList}},[r("el-button",{attrs:{slot:"trigger",type:"primary"},slot:"trigger"},[e._v("选择文件")]),e._v(" "),""!==e.enterpriseId?r("el-button",{attrs:{type:"success",disabled:e.wordButtonIsDisabled},on:{click:e.submitUpload}},[e._v("上传"),r("i",{staticClass:"el-icon-upload el-icon--right"})]):e._e(),e._v(" "),""!==e.otherEnterpriseId?r("el-button",{attrs:{type:"info",disabled:e.wordButtonIsDisabled},on:{click:e.otherSubmitUpload}},[e._v("上传"),r("i",{staticClass:"el-icon-upload el-icon--right"})]):e._e()],1)],1)]),e._v(" "),r("el-dialog",{attrs:{title:"企业信息",visible:e.dialogFormVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-form",{ref:"formWorkForm",attrs:{model:e.formWorkForm,disabled:e.formWorkForm.isDisabled,rules:e.rules,size:"mini"}},[r("div",{staticClass:"select-button"},[r("el-form-item",{attrs:{label:"模板选择","label-width":e.formLabelWidth,prop:"region"}},[r("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.formWorkForm.region,callback:function(t){e.$set(e.formWorkForm,"region",t)},expression:"formWorkForm.region"}},e._l(e.options,function(e){return r("el-option",{key:e.id,attrs:{label:e.tableName,value:e.id}})}),1)],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.selectFormWork("formWorkForm")}}},[e._v("确 定")])],1)],1)]),e._v(" "),r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,size:"mini",disabled:e.form.isDisabled}},[r("el-form-item",{attrs:{label:"单位名称","label-width":e.formLabelWidth,prop:"companyName"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.companyName,callback:function(t){e.$set(e.form,"companyName",t)},expression:"form.companyName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"主要负责人","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.principal,callback:function(t){e.$set(e.form,"principal",t)},expression:"form.principal"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"地址","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"填报人","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.informant,callback:function(t){e.$set(e.form,"informant",t)},expression:"form.informant"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"填报人联系电话","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.informantNumber,callback:function(t){e.$set(e.form,"informantNumber",t)},expression:"form.informantNumber"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"经度","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.lng,callback:function(t){e.$set(e.form,"lng",t)},expression:"form.lng"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"纬度","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.lat,callback:function(t){e.$set(e.form,"lat",t)},expression:"form.lat"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"全员人数","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.totalNumber,callback:function(t){e.$set(e.form,"totalNumber",t)},expression:"form.totalNumber"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"风险值（R）","label-width":e.formLabelWidth,prop:"riskValue"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.riskValue,callback:function(t){e.$set(e.form,"riskValue",e._n(t))},expression:"form.riskValue"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"措施","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.measure,callback:function(t){e.$set(e.form,"measure",t)},expression:"form.measure"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"主要危险源","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.majorDanger,callback:function(t){e.$set(e.form,"majorDanger",t)},expression:"form.majorDanger"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"主要风险名称","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.majorRiskName,callback:function(t){e.$set(e.form,"majorRiskName",t)},expression:"form.majorRiskName"}})],1),e._v(" "),r("el-form-item",[r("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.enterpriseFormDialogFormVisible("form")}}},[e._v("确 定")])],1)],1)],1),e._v(" "),!0===this.formShow?r("el-table",{staticStyle:{width:"100%"},attrs:{height:e.tableHeight,data:e.tableData}},[r("el-table-column",{attrs:{label:"企业类型",width:"350"},scopedSlots:e._u([{key:"default",fn:function(t){return[-1!==e.upGreen.indexOf(t.$index)?r("i",{staticClass:"el-icon-success",staticStyle:{color:"#67C23A"}}):r("i",{staticClass:"el-icon-success"}),e._v(" "),r("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.tableName))])]}}],null,!1,1904472429)}),e._v(" "),r("el-table-column",{attrs:{label:"类别",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.categoryId?r("span",{staticStyle:{"margin-left":"10px"}},[e._v("事故后果")]):e._e(),e._v(" "),2===t.row.categoryId?r("span",{staticStyle:{"margin-left":"10px"}},[e._v("可能性")]):e._e(),e._v(" "),3===t.row.categoryId?r("span",{staticStyle:{"margin-left":"10px"}},[e._v("暴露程度")]):e._e()]}}],null,!1,2043389412)}),e._v(" "),r("el-table-column",{attrs:{label:"影响因素",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.influenceFactor))])]}}],null,!1,2585739868)}),e._v(" "),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",type:"success",disabled:e.tableIsDistable},on:{click:function(r){return e.handleEdit(t.$index,t.row)}}},[e._v("录入\n        ")])]}}],null,!1,1307530139)})],1):r("div",{staticClass:"other-css"},[r("el-form",{ref:"otherForm",staticClass:"demo-otherForm",attrs:{model:e.otherForm,rules:e.rules,"label-width":"130px"}},[r("el-form-item",{attrs:{label:"评估类别：",prop:"valuationCategory"}},[r("el-input",{model:{value:e.otherForm.valuationCategory,callback:function(t){e.$set(e.otherForm,"valuationCategory",t)},expression:"otherForm.valuationCategory"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"主要风险类别：",prop:"majorRiskCategory"}},[r("el-input",{model:{value:e.otherForm.majorRiskCategory,callback:function(t){e.$set(e.otherForm,"majorRiskCategory",t)},expression:"otherForm.majorRiskCategory"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"L：",prop:"L"}},[r("el-input",{attrs:{type:"number"},model:{value:e.otherForm.L,callback:function(t){e.$set(e.otherForm,"L",e._n(t))},expression:"otherForm.L"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"E：",prop:"E"}},[r("el-input",{attrs:{type:"number"},model:{value:e.otherForm.E,callback:function(t){e.$set(e.otherForm,"E",e._n(t))},expression:"otherForm.E"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"C：",prop:"C"}},[r("el-input",{attrs:{type:"number"},model:{value:e.otherForm.C,callback:function(t){e.$set(e.otherForm,"C",e._n(t))},expression:"otherForm.C"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"R：",prop:"R"}},[r("el-input",{attrs:{type:"number"},model:{value:e.otherForm.R,callback:function(t){e.$set(e.otherForm,"R",e._n(t))},expression:"otherForm.R"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"风险等级：",prop:"riskLevel"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择风险等级"},model:{value:e.otherForm.riskLevel,callback:function(t){e.$set(e.otherForm,"riskLevel",t)},expression:"otherForm.riskLevel"}},[r("el-option",{attrs:{label:"重大风险",value:"重大风险"}}),e._v(" "),r("el-option",{attrs:{label:"较大风险",value:"较大风险"}}),e._v(" "),r("el-option",{attrs:{label:"一般风险",value:"一般风险"}}),e._v(" "),r("el-option",{attrs:{label:"低风险",value:"低风险"}}),e._v(" "),r("el-option",{attrs:{label:"可接受",value:"可接受"}})],1)],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.otherSubmitForm("otherForm")}}},[e._v("录入")]),e._v(" "),r("el-button",{on:{click:function(t){return e.otherResetForm("otherForm")}}},[e._v("重置")])],1)],1),e._v(" "),r("div",[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.otherTableData}},[r("el-table-column",{attrs:{label:"评估类别",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.valuationCategory))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"主要风险类别",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.majorRiskCategory))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"L",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.judgeL))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"E",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.judgeE))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"C",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.judgeC))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"R",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.judgeR))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"风险等级",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.riskLevel))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(r){return e.handleDelete(t.$index,t.row)}}},[e._v("修改\n            ")])]}}])})],1)],1)],1),e._v(" "),r("el-dialog",{attrs:{title:e.checkBoxForm.list.influenceFactor,visible:e.insertInfluenceFactorDialogFormVisible,width:"70%"},on:{"update:visible":function(t){e.insertInfluenceFactorDialogFormVisible=t}}},[r("el-form",{attrs:{model:e.checkBoxForm,rules:e.rules}},[r("el-form-item",[r("el-checkbox-group",{model:{value:e.checkBoxForm.type,callback:function(t){e.$set(e.checkBoxForm,"type",t)},expression:"checkBoxForm.type"}},e._l(this.checkBoxForm.list.tableDetailsList,function(t,a){return r("div",{key:a,staticClass:"checkbox-upload"},[r("el-checkbox",{attrs:{label:t.determineFactor}}),e._v(" "),r("el-upload",{staticClass:"upload-demo",attrs:{action:"http://localhost:7000/save/photo","on-preview":e.handlePreview,"on-success":function(r,a,o){return e.handleSuccess(r,a,o,t.photo)},"on-remove":e.handleRemove,"file-list":e.fileList,"list-type":"picture"}},[r("el-button",{attrs:{size:"small",type:"primary"}},[e._v("图片上传")])],1)],1)}),0)],1),e._v(" "),r("el-form-item",[r("el-button",{on:{click:e.downInsertInfluenceFactorDialogFormVisible}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.upInsertInfluenceFactorDialogFormVisible("checkBoxForm")}}},[e._v("确 定")])],1)],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"企业信息",visible:e.otherDialogFormVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.otherDialogFormVisible=t}}},[r("el-form",{ref:"otherEnterpriseForm",attrs:{model:e.otherEnterpriseForm,rules:e.rules,size:"mini"}},[r("el-form-item",{attrs:{label:"单位名称","label-width":e.formLabelWidth,prop:"otherCompanyName"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.otherEnterpriseForm.otherCompanyName,callback:function(t){e.$set(e.otherEnterpriseForm,"otherCompanyName",t)},expression:"otherEnterpriseForm.otherCompanyName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"主要负责人","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.otherEnterpriseForm.otherPrincipal,callback:function(t){e.$set(e.otherEnterpriseForm,"otherPrincipal",t)},expression:"otherEnterpriseForm.otherPrincipal"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"电话","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.otherEnterpriseForm.otherNumber,callback:function(t){e.$set(e.otherEnterpriseForm,"otherNumber",t)},expression:"otherEnterpriseForm.otherNumber"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"经度","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.otherEnterpriseForm.otherLng,callback:function(t){e.$set(e.otherEnterpriseForm,"otherLng",t)},expression:"otherEnterpriseForm.otherLng"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"纬度","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.otherEnterpriseForm.otherLat,callback:function(t){e.$set(e.otherEnterpriseForm,"otherLat",t)},expression:"otherEnterpriseForm.otherLat"}})],1),e._v(" "),r("el-form-item",[r("el-button",{on:{click:function(t){e.otherDialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.otherFormDialogFormVisible("otherEnterpriseForm")}}},[e._v("确 定")])],1)],1)],1)],1)},staticRenderFns:[]};var ze=r("VU/8")(Re,Ve,!1,function(e){r("WKmZ")},"data-v-f6ce63e8",null).exports,We={data:function(){return{loginForm:{userName:"",password:""},loginFormRules:{userName:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:1,max:8,message:"长度在 1 到 8 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:18,message:"长度在 6 到 18 个字符",trigger:"blur"}]}}},methods:{login:function(){var e,t=this;this.$refs.loginFormRef.validate((e=$e()(De.a.mark(function e(r){var a,o;return De.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$http.post("/get/login",t.loginForm);case 4:if(a=e.sent,"FAILED"!==(o=a.data).result){e.next=8;break}return e.abrupt("return",t.$message.error(o.message));case 8:return t.$message.success("登录成功"),window.sessionStorage.setItem("userId",o.data.id),e.next=12,t.$router.push("/home");case 12:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))}}},Ue={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login-container"},[r("div",{staticClass:"login-form"},[r("el-form",{ref:"loginFormRef",attrs:{model:e.loginForm,rules:e.loginFormRules,"label-width":"80px"}},[r("h2",{staticClass:"login-title"},[e._v("风险展示系统")]),e._v(" "),r("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[r("el-input",{attrs:{"prefix-icon":"el-icon-user"},model:{value:e.loginForm.userName,callback:function(t){e.$set(e.loginForm,"userName",t)},expression:"loginForm.userName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{"prefix-icon":"el-icon-lock",type:"password"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.login}},[e._v("登录")])],1)],1)],1)])},staticRenderFns:[]};var je=r("VU/8")(We,Ue,!1,function(e){r("zNS1")},"data-v-fc6981c0",null).exports,Be={data:function(){return{loading:!0,center:"",zoom:3,enterpriseList:[],show:!1,position:{},enterpriseInfo:{},riskDetails:{}}},mounted:function(){this.getAllEnterprise()},methods:{handler:function(e){e.BMap;var t=e.map;t.enableScrollWheelZoom(!0),t.setMapStyle({style:"normal"}),this.center="深圳观湖街道办",this.zoom=13},infoWindowOpen:function(e){this.show=!0,this.position={lng:parseFloat(e.lng),lat:parseFloat(e.lat)},this.enterpriseInfo=e,this.riskDetails=e.riskDeterminationTable},infoWindowClose:function(){this.show=!1},myInfoWindowOpen:function(){this.show=!0},getAllEnterprise:function(){var e=this;return $e()(De.a.mark(function t(){var r,a;return De.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/get/all/enterprise");case 2:r=t.sent,"SUCCESS"===(a=r.data).result&&(e.enterpriseList=a.data,e.loading=!1);case 5:case"end":return t.stop()}},t,e)}))()}}},Te={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("baidu-map",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"map",attrs:{center:e.center,zoom:e.zoom,"element-loading-text":"加载中...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"},on:{ready:e.handler}},[r("bm-navigation",{attrs:{anchor:"BMAP_ANCHOR_TOP_RIGHT"}}),e._v(" "),r("bm-geolocation",{attrs:{anchor:"BMAP_ANCHOR_BOTTOM_RIGHT",showAddressBar:!0,autoLocation:!0}}),e._v(" "),e._l(this.enterpriseList,function(t,a){return r("bm-marker",{key:a,attrs:{position:{lng:parseFloat(t.lng),lat:parseFloat(t.lat)},title:t.companyName,icon:{url:t.riskDeterminationTable.iconUrl,size:{width:30,height:30}}},on:{click:function(r){return e.infoWindowOpen(t)}}})}),e._v(" "),r("bm-info-window",{attrs:{position:e.position,show:e.show,title:e.enterpriseInfo.companyName},on:{close:e.infoWindowClose,open:e.myInfoWindowOpen}},[r("ul",[r("li",[e._v("单位名称："+e._s(e.enterpriseInfo.companyName))]),e._v(" "),r("li",[e._v("负责人："+e._s(e.enterpriseInfo.principal))]),e._v(" "),r("li",[e._v("填报人："+e._s(e.enterpriseInfo.informant))]),e._v(" "),r("li",[e._v("填报人电话："+e._s(e.enterpriseInfo.informantNumber))]),e._v(" "),r("li",[e._v("企业员工总数："+e._s(e.enterpriseInfo.totalNumber))]),e._v(" "),r("li",[e._v("单位地址："+e._s(e.enterpriseInfo.address))]),e._v(" "),r("li",[e._v("主要危险源："+e._s(e.enterpriseInfo.majorDanger))]),e._v(" "),r("li",[e._v("主要风险名称："+e._s(e.enterpriseInfo.majorRiskName))]),e._v(" "),r("li",[e._v("风险值："+e._s(e.enterpriseInfo.riskValue))]),e._v(" "),r("li",[e._v("风险等级："+e._s(e.riskDetails.riskLevel))]),e._v(" "),r("li",[e._v("措施："+e._s(e.riskDetails.riskMeasure))])])])],2)},staticRenderFns:[]};var Ae=r("VU/8")(Be,Te,!1,function(e){r("ylPd")},"data-v-646a6cb1",null).exports,He={data:function(){return{otherEnterpriseCompanyName:"",dialogVisible:!1,page:"",tableData:[],majorLevel:"",largerLevel:"",generalLevel:"",lowLevel:"",noLevel:"",otherEnterpriseCount:""}},computed:{myHeight:function(){return window.innerHeight-363+"px"}},mounted:function(){this.getEnterpriseRiskCount(),this.getOtherEnterpriseCount(),this.drawLine(),this.getAllOtherEnterprise(1)},methods:{handleEdit:function(e,t){this.otherEnterpriseCompanyName=t.otherCompanyName,this.drawOtherPie(t.id),this.dialogVisible=!0},handleCurrentChange:function(e){this.getAllOtherEnterprise(e)},getAllOtherEnterprise:function(e){var t=this;return $e()(De.a.mark(function r(){var a,o;return De.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$http.get("/get/all/other/enterprise",{params:{pageNum:e,pageSize:6}});case 2:a=r.sent,"SUCCESS"===(o=a.data).result&&(t.tableData=o.data.content,t.page=o.data);case 5:case"end":return r.stop()}},r,t)}))()},getOtherEnterpriseCount:function(){var e=this;return $e()(De.a.mark(function t(){var r,a;return De.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("get/other/enterprise/count");case 2:r=t.sent,"SUCCESS"===(a=r.data).result?e.otherEnterpriseCount=a.data:e.otherEnterpriseCount=0;case 5:case"end":return t.stop()}},t,e)}))()},otherDetails:function(){this.$router.push({path:"/otherEnterpriseRiskDetails"})},receptionDetails:function(){this.$router.push({path:"/enterpriseRiskDetails",query:{riskLevel:"可接受"}})},majorDetails:function(){this.$router.push({path:"/enterpriseRiskDetails",query:{riskLevel:"重大风险"}})},largerDetails:function(){this.$router.push({path:"/enterpriseRiskDetails",query:{riskLevel:"较大风险"}})},generalDetails:function(){this.$router.push({path:"/enterpriseRiskDetails",query:{riskLevel:"一般风险"}})},lowDetails:function(){this.$router.push({path:"/enterpriseRiskDetails",query:{riskLevel:"低风险"}})},getEnterpriseRiskCount:function(){var e=this;return $e()(De.a.mark(function t(){var r,a,o;return De.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/get/enterprise/risk/count");case 2:if(r=t.sent,"SUCCESS"===(a=r.data).result)for(o=0;o<a.data.length;o++)"重大风险"===a.data[o].riskLevel?e.majorLevel=a.data[o]:"较大风险"===a.data[o].riskLevel?e.largerLevel=a.data[o]:"一般风险"===a.data[o].riskLevel?e.generalLevel=a.data[o]:"低风险"===a.data[o].riskLevel?e.lowLevel=a.data[o]:e.noLevel=a.data[o];case 5:case"end":return t.stop()}},t,e)}))()},drawLine:function(){var e=this;return $e()(De.a.mark(function t(){var a,o,n,s,i,l,c,u,d,m;return De.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/get/enterprise/risk/count");case 2:a=t.sent,o=a.data,n=0,s=0,i=0,l=0,c=0,o.data.forEach(function(e,t){"重大风险"===e.riskLevel?n=e.count:"较大风险"===e.riskLevel?s=e.count:"一般风险"===e.riskLevel?i=e.count:"低风险"===e.riskLevel?l=e.count:c=e.count}),u=r("Icdr"),r("GbHy"),r("Vb+l"),r("Oq2I"),r("miEh"),r("80cc"),d=u.init(document.getElementById("main")),m={title:{text:"风险比重百分比",subtext:"",left:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left"},series:[{name:"数量（百分比）",type:"pie",radius:"55%",center:["50%","60%"],data:[{value:n,name:"重大风险",itemStyle:{color:"#F56C6C"}},{value:s,name:"较大风险",itemStyle:{color:"#E6A23C"}},{value:i,name:"一般风险",itemStyle:{color:"#FFFF77"}},{value:l,name:"低风险",itemStyle:{color:"#409EFF"}},{value:c,name:"可接受",itemStyle:{color:"#67C23A"}}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},d.setOption(m);case 19:case"end":return t.stop()}},t,e)}))()},drawOtherPie:function(e){var t=this;return $e()(De.a.mark(function a(){var o,n,s,i,l,c,u,d,m,p;return De.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$http.get("/get/other/enterprise/count/by/id",{params:{otherEnterpriseId:e}});case 2:o=a.sent,n=o.data,s=0,i=0,l=0,c=0,u=0,"SUCCESS"===n.result?n.data.forEach(function(e,t){"重大风险"===e.riskLevel?s=e.count:"较大风险"===e.riskLevel?i=e.count:"一般风险"===e.riskLevel?l=e.count:"低风险"===e.riskLevel?c=e.count:u=e.count}):t.$message.error("获取数据失败"),d=r("Icdr"),r("GbHy"),r("Vb+l"),r("Oq2I"),r("miEh"),r("80cc"),m=d.init(document.getElementById("otherPie")),p={title:{text:"主要风险类别比重百分比",subtext:"",left:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left"},series:[{name:"数量（百分比）",type:"pie",radius:"55%",center:["50%","60%"],data:[{value:s,name:"重大风险",itemStyle:{color:"#F56C6C"}},{value:i,name:"较大风险",itemStyle:{color:"#E6A23C"}},{value:l,name:"一般风险",itemStyle:{color:"#FFFF77"}},{value:c,name:"低风险",itemStyle:{color:"#409EFF"}},{value:u,name:"可接受",itemStyle:{color:"#67C23A"}}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},m.setOption(p);case 19:case"end":return a.stop()}},a,t)}))()}}},Oe={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-row",[r("el-col",{attrs:{span:4}},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("重大风险数量")]),e._v(" "),r("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.majorDetails}},[e._v("企业详情")])],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:24}},[r("div",{staticClass:"grid-content bg-purple"},[""===e.majorLevel?r("p",{staticStyle:{"font-size":"40px",color:"#F56C6C",margin:"0","padding-top":"25px"}},[e._v("\n              0\n            ")]):r("p",{staticStyle:{"font-size":"40px",color:"#F56C6C",margin:"0","padding-top":"25px"}},[e._v("\n              "+e._s(e.majorLevel.count)+"\n            ")])])])],1)],1)],1),e._v(" "),r("el-col",{attrs:{span:4}},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("较大风险数量")]),e._v(" "),r("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.largerDetails}},[e._v("企业详情")])],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:24}},[r("div",{staticClass:"grid-content bg-purple"},[""===e.largerLevel?r("p",{staticStyle:{"font-size":"40px",color:"#E6A23C",margin:"0","padding-top":"25px"}},[e._v("\n              0\n            ")]):r("p",{staticStyle:{"font-size":"40px",color:"#E6A23C",margin:"0","padding-top":"25px"}},[e._v("\n              "+e._s(e.largerLevel.count)+"\n            ")])])])],1)],1)],1),e._v(" "),r("el-col",{attrs:{span:4}},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("一般风险数量")]),e._v(" "),r("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.generalDetails}},[e._v("企业详情")])],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:24}},[r("div",{staticClass:"grid-content bg-purple"},[""===e.generalLevel?r("p",{staticStyle:{"font-size":"40px",color:"#FFFF77",margin:"0","padding-top":"25px"}},[e._v("\n              0\n            ")]):r("p",{staticStyle:{"font-size":"40px",color:"#FFFF77",margin:"0","padding-top":"25px"}},[e._v("\n              "+e._s(e.generalLevel.count)+"\n            ")])])])],1)],1)],1),e._v(" "),r("el-col",{attrs:{span:4}},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("低风险数量")]),e._v(" "),r("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.lowDetails}},[e._v("企业详情")])],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:24}},[r("div",{staticClass:"grid-content bg-purple"},[""===e.lowLevel?r("p",{staticStyle:{"font-size":"40px",color:"#409EFF",margin:"0","padding-top":"25px"}},[e._v("\n              0\n            ")]):r("p",{staticStyle:{"font-size":"40px",color:"#409EFF",margin:"0","padding-top":"25px"}},[e._v("\n              "+e._s(e.lowLevel.count)+"\n            ")])])])],1)],1)],1),e._v(" "),r("el-col",{attrs:{span:4}},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("可接受数量")]),e._v(" "),r("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.receptionDetails}},[e._v("企业详情")])],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:24}},[r("div",{staticClass:"grid-content bg-purple"},[""===e.noLevel?r("p",{staticStyle:{"font-size":"40px",color:"#67C23A",margin:"0","padding-top":"25px"}},[e._v("\n              0\n            ")]):r("p",{staticStyle:{"font-size":"40px",color:"#67C23A",margin:"0","padding-top":"25px"}},[e._v("\n              "+e._s(e.noLevel.count)+"\n            ")])])])],1)],1)],1),e._v(" "),r("el-col",{attrs:{span:4}},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("其他企业数量")]),e._v(" "),r("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.otherDetails}},[e._v("企业详情")])],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:24}},[r("div",{staticClass:"grid-content bg-purple"},[r("p",{staticStyle:{"font-size":"40px",color:"#909399",margin:"0","padding-top":"25px"}},[e._v("\n              "+e._s(e.otherEnterpriseCount)+"\n            ")])])])],1)],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:16}},[r("el-card",{staticClass:"echert-box-card",attrs:{"body-style":{height:e.myHeight}}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("数据概览")])]),e._v(" "),r("div",{attrs:{id:"main"}})])],1),e._v(" "),r("el-col",{attrs:{span:8}},[r("el-card",{staticClass:"echert-box-card",attrs:{"body-style":{height:e.myHeight}}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("其他企业数据概览")])]),e._v(" "),r("div",{attrs:{id:"otherMain"}},[r("el-table",{staticStyle:{width:"100%"},attrs:{height:"93%",data:e.tableData}},[r("el-table-column",{attrs:{fixed:"",label:"序号",type:"index",width:"50"}}),e._v(" "),r("el-table-column",{attrs:{label:"单位名称",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.otherCompanyName))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"负责人",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.otherPrincipal))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"电话",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.otherNumber))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"经度",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.otherLng))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"纬度",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.otherLat))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(r){return e.handleEdit(t.$index,t.row)}}},[e._v("查看")])]}}])})],1),e._v(" "),r("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","page-size":e.page.pageSize,total:e.page.totalSize},on:{"current-change":e.handleCurrentChange}})],1)])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:e.otherEnterpriseCompanyName,visible:e.dialogVisible,width:"40%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("div",{attrs:{id:"otherPie"}}),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var qe=r("VU/8")(He,Oe,!1,function(e){r("J7ij")},"data-v-063530d3",null).exports,Pe={data:function(){return{tableHeight:window.innerHeight-126,wordUrl:"",linkIsDisabled:!0,tableDetails:[],tableRow:0,url:"",srcList:[],dialogVisible:!1,myHeight:window.innerHeight-123,page:"",tableData:[],enterpriseInform:"",tableRiskDetails:""}},mounted:function(){this.getAllMajorEnterprise(1)},methods:{wordDownDialogVisible:function(){""===this.wordUrl||null===this.wordUrl?(this.$message.error("文档未上传！此文档不可下载"),this.dialogVisible=!0):(this.$message.success("文档下载成功"),this.dialogVisible=!1)},getWordUrl:function(e){var t=this;return $e()(De.a.mark(function r(){var a,o;return De.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$http.get("/get/word/url",{params:{enterpriseId:e}});case 2:a=r.sent,"SUCCESS"===(o=a.data).result&&(""===o.data||null===o.data?(t.wordUrl="",t.linkIsDisabled=!0):(t.wordUrl=o.data,t.linkIsDisabled=!1));case 5:case"end":return r.stop()}},r,t)}))()},getTableRiskDetails:function(e){var t=this;return $e()(De.a.mark(function r(){var a,o;return De.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$http.get("/get/table/risk/details/by/id",{params:{tableId:e}});case 2:a=r.sent,"SUCCESS"===(o=a.data).result&&(t.tableRiskDetails=o.data);case 5:case"end":return r.stop()}},r,t)}))()},getTableDetailsByTableId:function(e){var t=this;return $e()(De.a.mark(function r(){var a,o;return De.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t.enterpriseInform=e,r.next=3,t.$http.get("/get/table/details/by/id",{params:{tableId:e.companyType,enterpriseId:e.id}});case 3:a=r.sent,"SUCCESS"===(o=a.data).result&&(t.tableDetails=o.data,t.tableDetails.forEach(function(e,t){e.photo=(e.photo||"").split(",")}));case 6:case"end":return r.stop()}},r,t)}))()},handleClose:function(e){this.$confirm("确认关闭？").then(function(t){e()}).catch(function(e){})},handleCurrentChange:function(e){this.getAllMajorEnterprise(e)},getAllMajorEnterprise:function(e){var t=this;return $e()(De.a.mark(function r(){var a,o;return De.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$http.get("/get/all/risk/enterprise",{params:{riskLevel:t.$route.query.riskLevel,pageNum:e,pageSize:8}});case 2:a=r.sent,"SUCCESS"===(o=a.data).result&&(t.page=o.data,t.tableData=o.data.content);case 5:case"end":return r.stop()}},r,t)}))()},goBack:function(){this.$router.go(-1)},handleClick:function(e){this.getTableDetailsByTableId(e),this.getTableRiskDetails(e.companyType),this.getWordUrl(e.id),this.dialogVisible=!0}}},Ge={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-page-header",{attrs:{content:this.$route.query.riskLevel+"企业详情"},on:{back:e.goBack}}),e._v(" "),r("el-table",{staticStyle:{width:"100%"},attrs:{height:e.tableHeight,data:e.tableData,border:""}},[r("el-table-column",{attrs:{fixed:"",label:"序号",type:"index",width:"50"}}),e._v(" "),r("el-table-column",{attrs:{fixed:"",prop:"companyName",label:"单位名称",width:"240"}}),e._v(" "),r("el-table-column",{attrs:{prop:"principal",label:"负责人",width:"120"}}),e._v(" "),r("el-table-column",{attrs:{prop:"informantNumber",label:"填报人电话",width:"120"}}),e._v(" "),r("el-table-column",{attrs:{prop:"riskValue",label:"风险值",width:"70"}}),e._v(" "),r("el-table-column",{attrs:{prop:"measure",label:"措施",width:"70"}}),e._v(" "),r("el-table-column",{attrs:{prop:"totalNumber",label:"总人数",width:"70"}}),e._v(" "),r("el-table-column",{attrs:{prop:"majorDanger",label:"主要危险源",width:"120"}}),e._v(" "),r("el-table-column",{attrs:{prop:"majorRiskName",label:"主要风险名称",width:"120"}}),e._v(" "),r("el-table-column",{attrs:{prop:"address",label:"地址",width:"300"}}),e._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.handleClick(t.row)}}},[e._v("查看")])]}}])})],1),e._v(" "),r("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","page-size":e.page.pageSize,total:e.page.totalSize},on:{"current-change":e.handleCurrentChange}}),e._v(" "),r("el-dialog",{attrs:{title:e.enterpriseInform.companyName,visible:e.dialogVisible,width:"50%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("div",{staticClass:"mytable"},[r("table",{attrs:{border:"1",cellspacing:"0",align:"center"}},[r("tr",[r("th",[e._v("类别")]),e._v(" "),r("th",[e._v("影响因素")]),e._v(" "),r("th",[e._v("判定要素")]),e._v(" "),r("th",[e._v("赋分标准")]),e._v(" "),r("th",[e._v("具体情况")]),e._v(" "),r("th",[e._v("现场照片")])]),e._v(" "),e._l(e.tableDetails,function(t,a){return r("tr",{key:a},[1===t.categoryId?r("td",{attrs:{rowspan:"1"}},[e._v("事故后果")]):2===t.categoryId?r("td",[e._v("可能性")]):3===t.categoryId?r("td",[e._v("暴露程度")]):e._e(),e._v(" "),r("td",[e._v(e._s(t.influenceFactor))]),e._v(" "),r("td",[e._v(e._s(t.determineFactor))]),e._v(" "),r("td",[e._v(e._s(t.score))]),e._v(" "),r("td",[e._v(e._s(t.check))]),e._v(" "),r("td",[r("el-image",{staticStyle:{width:"30px",height:"30px"},attrs:{src:t.photo[0],"preview-src-list":t.photo}},[r("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[e._v("\n              加载中"),r("span",{staticClass:"dot"},[e._v("...")])]),e._v(" "),r("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[r("p")])])],1)])}),e._v(" "),r("tr",[r("td",[e._v("风险值")]),e._v(" "),r("td",[e._v(e._s(e.enterpriseInform.riskValue))]),e._v(" "),r("td",[e._v("措施")]),e._v(" "),r("td",[e._v(e._s(e.enterpriseInform.measure))]),e._v(" "),r("td",{attrs:{colspan:"2"}},[e._v("事故风险值=事故后果*事故可能性*人群暴露程度")])]),e._v(" "),r("tr",[r("td",[e._v("主要危险源")]),e._v(" "),r("td",[e._v(e._s(e.enterpriseInform.majorDanger))]),e._v(" "),r("td",[e._v("主要风险名称")]),e._v(" "),r("td",{attrs:{colspan:"3"}},[e._v(e._s(e.enterpriseInform.majorRiskName))])]),e._v(" "),r("tr",[r("td",[e._v("单位名称")]),e._v(" "),r("td",[e._v(e._s(e.enterpriseInform.companyName))]),e._v(" "),r("td",[e._v("地址")]),e._v(" "),r("td",[e._v(e._s(e.enterpriseInform.address))]),e._v(" "),r("td",[e._v("经纬度")]),e._v(" "),r("td",[e._v(e._s(e.enterpriseInform.lng)),r("br"),e._v(e._s(e.enterpriseInform.lat))])]),e._v(" "),r("tr",[r("td",[e._v("主要负责人")]),e._v(" "),r("td",[e._v(e._s(e.enterpriseInform.principal))]),e._v(" "),r("td",[e._v("填报人及联系电话")]),e._v(" "),r("td",[e._v(e._s(e.enterpriseInform.informant)),r("br"),e._v(e._s(e.enterpriseInform.informantNumber))]),e._v(" "),r("td",[e._v("全员人数")]),e._v(" "),r("td",[e._v(e._s(e.enterpriseInform.totalNumber))])])],2),e._v(" "),r("p",[e._v("计算说明：")]),e._v(" "),e._l(e.tableRiskDetails.computerExplainList,function(t,a){return r("p",{key:a},[e._v(e._s(t.computerCount))])}),e._v(" "),r("h5",[e._v("附：工业企业点位风险等级判定表")]),e._v(" "),r("table",{attrs:{border:"1",cellspacing:"0",align:"center"}},[r("tr",[r("th",[e._v("风险分级标准(R)")]),e._v(" "),r("th",[e._v("风险等级")]),e._v(" "),r("th",[e._v("措施")]),e._v(" "),r("th",[e._v("表示色")])]),e._v(" "),r("tr",[r("td",[e._v(e._s(e.tableRiskDetails.rmajorRisk))]),e._v(" "),r("td",[e._v("重大风险")]),e._v(" "),r("td",[e._v("不可容许、停工")]),e._v(" "),r("td",{attrs:{bgcolor:"#F56C6C"}},[e._v("红色")])]),e._v(" "),r("tr",[r("td",[e._v(e._s(e.tableRiskDetails.rlargerRisk))]),e._v(" "),r("td",[e._v("较大风险")]),e._v(" "),r("td",[e._v("立即整改，方案、验收")]),e._v(" "),r("td",{attrs:{bgcolor:"orange"}},[e._v("橙色")])]),e._v(" "),r("tr",[r("td",[e._v(e._s(e.tableRiskDetails.rgeneralRisk))]),e._v(" "),r("td",[e._v("一般风险")]),e._v(" "),r("td",[e._v("需要整改，整改、检查")]),e._v(" "),r("td",{attrs:{bgcolor:"yellow"}},[e._v("黄色")])]),e._v(" "),r("tr",[r("td",[e._v(e._s(e.tableRiskDetails.rlowRisk))]),e._v(" "),r("td",[e._v("低风险")]),e._v(" "),r("td",[e._v("需要注意，培训、检查")]),e._v(" "),r("td",{attrs:{bgcolor:"#409EFF"}},[e._v("蓝色")])])])],2),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("关闭")]),e._v(" "),r("el-link",{attrs:{href:e.wordUrl,disabled:e.linkIsDisabled}},[r("el-button",{attrs:{type:"primary"},on:{click:e.wordDownDialogVisible}},[e._v("下载文档")])],1)],1)])],1)},staticRenderFns:[]};var Me=r("VU/8")(Pe,Ge,!1,function(e){r("xaYh")},"data-v-0b9d7d27",null).exports,Je={data:function(){return{tableDetails:[],tableRow:0,url:"https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg",srcList:["https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg","https://fuss10.elemecdn.com/1/8e/aeffeb4de74e2fde4bd74fc7b4486jpeg.jpeg"]}},mounted:function(){this.getTableDetailsByTableId()},methods:{getTableDetailsByTableId:function(){var e=this;return $e()(De.a.mark(function t(){var r,a;return De.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/get/table/details/by/id",{params:{tableId:e.$route.query.row.companyType,enterpriseId:e.$route.query.row.id}});case 2:r=t.sent,"SUCCESS"===(a=r.data).result&&(e.tableDetails=a.data,e.tableDetails.forEach(function(e,t){e.photo=(e.photo||"").split(","),console.log(e.photo)}));case 5:case"end":return t.stop()}},t,e)}))()}}},Xe={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"mytable"},[r("h3",[e._v("2020年"+e._s(this.$route.query.row.companyName)+"风险详情")]),e._v(" "),r("table",{attrs:{border:"1",cellspacing:"0",align:"center"}},[e._m(0),e._v(" "),e._l(e.tableDetails,function(t,a){return r("tr",{key:a},[1===t.categoryId?r("td",{attrs:{rowspan:"1"}},[e._v("事故后果")]):2===t.categoryId?r("td",[e._v("可能性")]):3===t.categoryId?r("td",[e._v("暴露程度")]):e._e(),e._v(" "),r("td",[e._v(e._s(t.influenceFactor))]),e._v(" "),r("td",[e._v(e._s(t.determineFactor))]),e._v(" "),r("td",[e._v(e._s(t.score))]),e._v(" "),r("td",[e._v(e._s(t.check))]),e._v(" "),r("td",[r("el-image",{staticStyle:{width:"30px",height:"30px"},attrs:{src:t.photo[0],"preview-src-list":t.photo}},[r("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[e._v("\n          加载中"),r("span",{staticClass:"dot"},[e._v("...")])]),e._v(" "),r("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[r("p")])])],1)])})],2)])},staticRenderFns:[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("tr",[r("th",[e._v("类别")]),e._v(" "),r("th",[e._v("影响因素")]),e._v(" "),r("th",[e._v("判定要素")]),e._v(" "),r("th",[e._v("赋分标准")]),e._v(" "),r("th",[e._v("具体情况")]),e._v(" "),r("th",[e._v("现场照片")])])}]};var Ke=r("VU/8")(Je,Xe,!1,function(e){r("WW0r")},"data-v-1c8db31c",null).exports,Qe={data:function(){return{tableHeight:window.innerHeight-126,tableData:[],page:"",dialogVisible:!1,otherEnterpriseCompanyName:"",otherEnterpriseDetails:[],otherWordUrl:"",linkIsDisabled:!0}},mounted:function(){this.getAllOtherEnterprise(1)},methods:{wordDownDialogVisible:function(){""===this.otherWordUrl||null===this.otherWordUrl?(this.$message.error("文档未上传！此文档不可下载"),this.dialogVisible=!0):(this.$message.success("文档下载成功"),this.dialogVisible=!1)},getOtherWordUrl:function(e){var t=this;return $e()(De.a.mark(function r(){var a,o;return De.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$http.get("/get/other/word/url",{params:{otherEnterpriseId:e}});case 2:a=r.sent,"SUCCESS"===(o=a.data).result&&(""===o.data||null===o.data?(t.otherWordUrl="",t.linkIsDisabled=!0):(t.otherWordUrl=o.data,t.linkIsDisabled=!1));case 5:case"end":return r.stop()}},r,t)}))()},goBack:function(){this.$router.go(-1)},handleEdit:function(e,t){this.otherEnterpriseCompanyName=t.otherCompanyName,this.getAllOtherEnterpriseDetails(t.id),this.getOtherWordUrl(t.id),this.dialogVisible=!0},handleCurrentChange:function(e){this.getAllOtherEnterprise(e)},getAllOtherEnterpriseDetails:function(e){var t=this;return $e()(De.a.mark(function r(){var a,o;return De.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$http.get("/get/other/enterprise/details/by/id",{params:{otherEnterpriseId:e}});case 2:a=r.sent,"SUCCESS"===(o=a.data).result&&(t.otherEnterpriseDetails=o.data);case 5:case"end":return r.stop()}},r,t)}))()},getAllOtherEnterprise:function(e){var t=this;return $e()(De.a.mark(function r(){var a,o;return De.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$http.get("/get/all/other/enterprise",{params:{pageNum:e,pageSize:10}});case 2:a=r.sent,"SUCCESS"===(o=a.data).result&&(t.tableData=o.data.content,t.page=o.data);case 5:case"end":return r.stop()}},r,t)}))()}}},Ye={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-page-header",{attrs:{content:"其他企业详情"},on:{back:e.goBack}}),e._v(" "),r("el-table",{staticStyle:{width:"100%"},attrs:{height:e.tableHeight,data:e.tableData}},[r("el-table-column",{attrs:{fixed:"",label:"序号",type:"index",width:"50"}}),e._v(" "),r("el-table-column",{attrs:{fixed:"",label:"单位名称",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.otherCompanyName))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"负责人",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.otherPrincipal))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"电话",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.otherNumber))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"经度",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.otherLng))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"纬度",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.otherLat))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(r){return e.handleEdit(t.$index,t.row)}}},[e._v("查看")])]}}])})],1),e._v(" "),r("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","page-size":e.page.pageSize,total:e.page.totalSize},on:{"current-change":e.handleCurrentChange}}),e._v(" "),r("el-dialog",{attrs:{title:e.otherEnterpriseCompanyName,visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("div",{staticClass:"mytable"},[r("table",{attrs:{border:"1",cellspacing:"0",align:"center"}},[r("tr",[r("th",[e._v("评估类别")]),e._v(" "),r("th",[e._v("主要风险类别")]),e._v(" "),r("th",[e._v("L")]),e._v(" "),r("th",[e._v("E")]),e._v(" "),r("th",[e._v("C")]),e._v(" "),r("th",[e._v("R")]),e._v(" "),r("th",[e._v("风险等级")])]),e._v(" "),e._l(this.otherEnterpriseDetails,function(t,a){return r("tr",{key:a},[r("td",[e._v(e._s(t.valuationCategory))]),e._v(" "),r("td",[e._v(e._s(t.majorRiskCategory))]),e._v(" "),r("td",[e._v(e._s(t.judgeL))]),e._v(" "),r("td",[e._v(e._s(t.judgeE))]),e._v(" "),r("td",[e._v(e._s(t.judgeC))]),e._v(" "),r("td",[e._v(e._s(t.judgeR))]),e._v(" "),"重大风险"===t.riskLevel?r("td",{attrs:{bgcolor:"#F56C6C"}},[e._v("重大风险")]):"较大风险"===t.riskLevel?r("td",{attrs:{bgcolor:"orange"}},[e._v("较大风险")]):"一般风险"===t.riskLevel?r("td",{attrs:{bgcolor:"yellow"}},[e._v("一般风险")]):"低风险"===t.riskLevel?r("td",{attrs:{bgcolor:"#409EFF"}},[e._v("低风险")]):r("td",{attrs:{bgcolor:"#67C23A"}},[e._v("可接受")])])})],2),e._v(" "),r("p",[e._v("\n        附：风险评估方法\n      ")]),e._v(" "),r("p",[e._v("\n        城市具有人员高度集中的特点，应当充分考虑人员聚集带来的城市风险。基于人群暴 露程度的风险评估方法利用灾害事故发生的可能性、人群暴露于危险环境的程度和发生灾 害事故可能造成的后果严重性三种因素指标值的乘积来评估风险大小。各项因素的赋值见 附表1，各项分数值及相应的判定因素也可根据实际情况进行调整。\n      ")]),e._v(" "),r("table",{attrs:{border:"1",cellspacing:"0",align:"center"}},[r("tr",[r("th",{attrs:{colspan:"2"}},[e._v("发生灾害事故的可能性(L)")])]),e._v(" "),r("tr",[r("td",[e._v("分数值")]),e._v(" "),r("td",[e._v("事故发生可能性")])]),e._v(" "),r("tr",[r("td",[e._v("10")]),e._v(" "),r("td",[e._v("完全可以预料")])]),e._v(" "),r("tr",[r("td",[e._v("6")]),e._v(" "),r("td",[e._v("相当可能")])]),e._v(" "),r("tr",[r("td",[e._v("3")]),e._v(" "),r("td",[e._v("可能，但不经常")])]),e._v(" "),r("tr",[r("td",[e._v("1")]),e._v(" "),r("td",[e._v("可能性小")])]),e._v(" "),r("tr",[r("td",[e._v("0.5")]),e._v(" "),r("td",[e._v("很不可能")])]),e._v(" "),r("tr",[r("td",[e._v("0.1")]),e._v(" "),r("td",[e._v("极不可能")])]),e._v(" "),r("tr",[r("th",{attrs:{colspan:"2"}},[e._v("人群暴露于危险环境的程度(E)")])]),e._v(" "),r("tr",[r("td",[e._v("分数值")]),e._v(" "),r("td",[e._v("人群暴露于危险环境的程度")])]),e._v(" "),r("tr",[r("td",[e._v("10")]),e._v(" "),r("td",[e._v("大量敏感人群直接暴露于危险环境中")])]),e._v(" "),r("tr",[r("td",[e._v("6")]),e._v(" "),r("td",[e._v("少量敏感人群直接暴露于危险环境中")])]),e._v(" "),r("tr",[r("td",[e._v("3")]),e._v(" "),r("td",[e._v("大量非敏感人群直接暴露于危险环境中")])]),e._v(" "),r("tr",[r("td",[e._v("2")]),e._v(" "),r("td",[e._v("有一定量的非敏感人群直接暴露于危险环境中")])]),e._v(" "),r("tr",[r("td",[e._v("1")]),e._v(" "),r("td",[e._v("少量非敏感人群暴露于危险环境中")])]),e._v(" "),r("tr",[r("td",[e._v("0.5")]),e._v(" "),r("td",[e._v("几乎没有人群暴露于危险环境中")])]),e._v(" "),r("tr",[r("th",{attrs:{colspan:"2"}},[e._v("发生灾害事故后果严重性(C)")])]),e._v(" "),r("tr",[r("td",[e._v("分数值")]),e._v(" "),r("td",[e._v("发生灾害事故产生的后果")])]),e._v(" "),r("tr",[r("td",[e._v("100")]),e._v(" "),r("td",[e._v("造成 30 人以上（含 30 人）死亡，或者 100 人以上重伤（包括急性工业中毒，下同），或者 1 亿元以上直接经济损失。")])]),e._v(" "),r("tr",[r("td",[e._v("40")]),e._v(" "),r("td",[e._v("造成 10 人～29 人死亡，或者 50 人～99 人重伤，或者 5000万元以上 1 亿元以下直接经济损失。")])]),e._v(" "),r("tr",[r("td",[e._v("15")]),e._v(" "),r("td",[e._v("造成 3 人～9 人死亡，或者 10 人～49 人重伤，或者 1000 万元以上 5000 万元以下直接经济损失。")])]),e._v(" "),r("tr",[r("td",[e._v("7")]),e._v(" "),r("td",[e._v("造成 3 人以下死亡，或者 10 人以下重伤，或者 1000 万元以下直接经济损失。")])]),e._v(" "),r("tr",[r("td",[e._v("3")]),e._v(" "),r("td",[e._v("无人员死亡，致残或重伤，或很小的财产损失。")])]),e._v(" "),r("tr",[r("td",[e._v("1")]),e._v(" "),r("td",[e._v("引人注目，不利于基本的安全要求。")])]),e._v(" "),r("tr",[r("td",{attrs:{colspan:"2"}},[e._v("注：敏感人群是指在灾害事故场景下自我防护能力相对较低的群体，包括中小学生、医院病人、养 老院老人等。")])])]),e._v(" "),r("p",[e._v("风险等级由R值的大小确定，不同风险等级对应的R值一般根据经验进行划分，风险分级标准可参考表附表2执行，也可根据实际情况自行划定。")]),e._v(" "),r("br"),e._v(" "),r("p",[e._v("附表2 风险分级标准")]),e._v(" "),r("table",{attrs:{border:"1",cellspacing:"0",align:"center"}},[r("tr",[r("th",[e._v("风险分级标准(R)")]),e._v(" "),r("th",[e._v("风险等级")]),e._v(" "),r("th",[e._v("措施")]),e._v(" "),r("th",[e._v("表示色")])]),e._v(" "),r("tr",[r("td",[e._v("≥720")]),e._v(" "),r("td",[e._v("重大风险")]),e._v(" "),r("td",[e._v("不可容许、停工")]),e._v(" "),r("td",{attrs:{bgcolor:"#F56C6C"}},[e._v("红色")])]),e._v(" "),r("tr",[r("td",[e._v("720＞R≥240")]),e._v(" "),r("td",[e._v("较大风险")]),e._v(" "),r("td",[e._v("立即整改，方案、验收")]),e._v(" "),r("td",{attrs:{bgcolor:"orange"}},[e._v("橙色")])]),e._v(" "),r("tr",[r("td",[e._v("240＞R≥150")]),e._v(" "),r("td",[e._v("一般风险")]),e._v(" "),r("td",[e._v("需要整改，整改、检查")]),e._v(" "),r("td",{attrs:{bgcolor:"yellow"}},[e._v("黄色")])]),e._v(" "),r("tr",[r("td",[e._v("150＞R≥70")]),e._v(" "),r("td",[e._v("低风险")]),e._v(" "),r("td",[e._v("需要注意，培训、检查")]),e._v(" "),r("td",{attrs:{bgcolor:"#409EFF"}},[e._v("蓝色")])])])]),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-link",{attrs:{href:e.otherWordUrl,disabled:e.linkIsDisabled}},[r("el-button",{attrs:{type:"primary"},on:{click:e.wordDownDialogVisible}},[e._v("下载文档")])],1)],1)])],1)},staticRenderFns:[]};var Ze=r("VU/8")(Qe,Ye,!1,function(e){r("yEVG")},"data-v-4439e36e",null).exports;ge.default.use(ye.a);var et=new ye.a({routes:[{path:"/",name:"Login",component:je},{path:"/login",name:"Login",component:je},{path:"/home",name:"Home",component:Ce,redirect:"/enterpriseInformation",children:[{path:"/tableinsert",component:Ne},{path:"/insertEnterpriseDetails",component:ze},{path:"/enterpriseDistributionMap",component:Ae},{path:"/enterpriseInformation",component:qe},{path:"/enterpriseRiskDetails",component:Me},{path:"/enterpriseTableDetails",component:Ke},{path:"/otherEnterpriseRiskDetails",component:Ze}]}]});et.beforeEach(function(e,t,r){return"/login"===e.path?r():window.sessionStorage.getItem("userId")?void r():r("/login")});var tt=et,rt=(r("tvR6"),r("mtWM")),at=r.n(rt),ot=r("dAEq"),nt=r.n(ot);ge.default.use(be.a,he.a,ve.a,me.a,ue.a,le.a,se.a),ge.default.use(he.a),ge.default.use(ve.a),ge.default.use(me.a),ge.default.use(ue.a),ge.default.use(le.a),ge.default.use(se.a),ge.default.use(oe.a),ge.default.use(re.a),ge.default.use(ee.a),ge.default.use(Y.a),ge.default.use(K.a),ge.default.use(J.a),ge.default.use(G.a),ge.default.use(q.a),ge.default.use(H.a),ge.default.use(T.a),ge.default.use(j.a),ge.default.use(W.a),ge.default.use(V.a),ge.default.use(N.a),ge.default.use(I.a),ge.default.use(E.a),ge.default.use(S.a),ge.default.use(x.a),ge.default.use(y.a),ge.default.use(k.a),ge.default.use(b.a),ge.default.use(h.a),ge.default.use(v.a),ge.default.use(m.a),ge.default.use(u.a),ge.default.use(l.a),ge.default.prototype.$message=s.a,ge.default.prototype.$confirm=o.a.confirm,ge.default.use(nt.a,{ak:"wFQlNo1lSDLEx8RV6vehHiwLKlx23GNg"}),ge.default.config.productionTip=!1,at.a.defaults.baseURL="http://localhost:7000",ge.default.prototype.$http=at.a,new ge.default({el:"#app",router:tt,components:{App:Fe},template:"<App/>"})},NOFV:function(e,t){},Q6SQ:function(e,t){},TFIm:function(e,t){},WKmZ:function(e,t){},WW0r:function(e,t){},"X+ky":function(e,t){},Yq4J:function(e,t){},Z1wW:function(e,t){},ZzA9:function(e,t){},bwiK:function(e,t){},cDSy:function(e,t){},cwe7:function(e,t){},d7TW:function(e,t){},dmRH:function(e,t){},hXTu:function(e,t){},isE6:function(e,t){},jAzQ:function(e,t){},jZDA:function(e,t){},oq7i:function(e,t){},qunJ:function(e,t){},rRW2:function(e,t){},tvR6:function(e,t){},uKbn:function(e,t){},vBcO:function(e,t){},"voD/":function(e,t,r){e.exports=r.p+"static/img/003.ecad204.jpg"},w2s5:function(e,t){},wJKS:function(e,t){},xBlb:function(e,t){},xaYh:function(e,t){},yEVG:function(e,t){},ylPd:function(e,t){},ylrw:function(e,t){},zNS1:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.29b95f6a6f1b0b39c368.js.map